原始数据矩阵 Data (n × m)
┌─────────────────────────────┐
│  n 行 → 样本                │
│  m 列 → 指标                │
└─────────────────────────────┘
            │
            ▼
1️⃣ 数据归一化 (Normalization)
   ┌─────────────────────────────┐
   │ Z(i,j) = (x_ij - min_j)/range_j  (效益型) │
   │ Z(i,j) = (max_j - x_ij)/range_j  (成本型) │
   │ Pitfall Fix 1: range_j=0 → Z(:,j)=1/n │
   └─────────────────────────────┘
            │
            ▼
2️⃣ 计算概率矩阵 P
   ┌─────────────────────────────┐
   │ P(i,j) = Z(i,j) / sum(Z(:,j))           │
   │ Pitfall Fix 2: sum(Z(:,j))=0 → P(:,j)=1/n │
   └─────────────────────────────┘
            │
            ▼
3️⃣ 计算熵值 E
   ┌─────────────────────────────┐
   │ E_j = -k * sum_i ( P(i,j) * ln(P(i,j)) ) │
   │ k = 1 / ln(n)                             │
   │ Pitfall Fix 3: P(i,j)=0 时忽略 ln(0)     │
   └─────────────────────────────┘
            │
            ▼
4️⃣ 计算信息效用 D
   ┌─────────────────────────────┐
   │ D_j = 1 - E_j                           │
   └─────────────────────────────┘
            │
            ▼
5️⃣ 计算权重 W
   ┌─────────────────────────────┐
   │ Pitfall Fix 4: sum(D)=0 → W = ones(1,m)/m │
   │ 否则 W = D / sum(D)                        │
   └─────────────────────────────┘
            │
            ▼
6️⃣ 计算综合评分 Score
   ┌─────────────────────────────┐
   │ Score = 100 * Z * W'          │
   │ (每行样本按权重求加权平均)    │
   └─────────────────────────────┘
            │
            ▼
最终输出
┌─────────────┐
│ W     → 权重 │
│ Score → 样本综合得分 (0~100) │
└─────────────┘
